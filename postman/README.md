## Поток данных

### 1. POST /postman/forecasts/v1/forecast (Требует обычный access token)
1. Пользователь обращается в postman напрямую или через envoy, передавая необходимые параметры
для запроса.
2. Делается проверка, есть ли данные в кэше. Ключем для сохранения прогноза является хэш всех
параметров для прогноза. Кэш хранится время равное таймфрейму прогноза(то есть если у нас 
дневной таймфрейм, то кэш будет удален через день). Если у нас есть закэшированный прогноз,
то postman сразу его возвращает, иначе делает запрос через Kafka в сервис magician 
для получения свежего прогноза. В обоих случаях запросы для получения предсказаний записываются в базу данных.
После этого возвращается статус 201.
3. Kafka consumer в асинхронном режиме ожидает прогноза от magician. При получении результата
сервис обновляет информацию о запросе в базе данных, кэширует прогноз в случае, если статус
"Completed". Наконец сервис отправляет полученный прогноз через kafka topic в сервис envoy
для отправки пользователю. 

### 2. POST /postman/info/v1/stats (Требует админский access token)
Этот запрос, как и все прочие админские делается напрямую в сервис и позволяет получить
статистику по сохраненным в базе данных запросам. Можно отправить пустое тело, тогда 
обработка будет идти по всем записям или добавить различные фильтры, чтобы рассмотреть 
конкретную категорию запросов. Метрики, которые возвращаются можно переопределять с помощью
[конфига](src/services/config/stats_metrics_conf.testing.yaml),
но необходимо добавить реализации для новых метрик, на данный момент есть реализация
для среднего значения и квантилей по произвольному проценту. После фильтрации и составления метрик по длительности выполнения результат возвращается
пользователю

### 3. POST /postman/info/v1/history (Требует админский access token)
Запрос делается напрямую в сервис и позволяет получить историю запросов в сервис postman.
Аналогично с тем, как делается фильтрация в */postman/info/v1/stats* тут можно отобрать
записи по каким-то конкретным полям.

### 4. DELETE /postman/info/v1/history (Требует админский access token)
Запрос очищает всю историю запросов в сервис. Данные удаляются только из базы данных,
кэш здесь не затрагивается!